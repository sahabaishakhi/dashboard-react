import React, { useState, useMemo, useEffect } from "react";
import { KeyboardDateTimePicker } from "@material-ui/pickers";
import { sub } from "date-fns";
import { useStateValue } from "/@ianalytics/d4d/components/StateProvider";
import { Button, Menu, MenuItem, Typography } from "@material-ui/core";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faCalendar, faCalendarAlt, faChevronLeft, faChevronRight, faChevronDoubleLeft, faChevronDoubleRight, faSync } from "@fortawesome/free-solid-svg-icons";
export default DateRangePicker = function (props) {
  const [state, dispatch] = useStateValue();
  const {
    from,
    to
  } = state.timeSelection;
  const [selectedFrom, setSelectedFrom] = useState(from);
  const [selectedTo, setSelectedTo] = useState(to);
  const [anchorEl, setAnchorEl] = useState(null);
  const [dateRange, setDateRange] = useState(state.timeSelection.mode);
  useEffect(() => {
    if (state.plotsAutoUpdate) {
      const interval = setInterval(function () {
        if (dateRange !== "CUSTOM") {
          dispatchTimes(from, new Date());
        }
      }, 5000);
      return () => clearInterval(interval);
    }
  }, [state.plotsAutoUpdate]);

  function toggle_autoupdate() {
    dispatch({
      type: "TOGGLE_REFRESH",
      dispatch: dispatch
    });
  }

  useEffect(() => {
    setSelectedFrom(from);
    setSelectedTo(to);
  }, [from, to]);

  function dispatchTimes(newFrom, newTo) {
    if (newFrom < newTo) {
      dispatch({
        type: "SELECT_TIME_RANGE",
        payload: {
          from: newFrom,
          to: newTo
        },
        dispatch: dispatch
      });
    }
  }

  function dispatchSelectedTimes() {
    dispatchTimes(selectedFrom, selectedTo);
  }

  function handleKeyEvent(event) {
    if (event.key === "Enter") {
      dispatchSelectedTimes();
    }
  }

  function slideTimeWindow(factor) {
    const delta = selectedTo - selectedFrom;
    dispatchTimes(new Date(from.getTime() + factor * delta), new Date(to.getTime() + factor * delta));
    setDateRange("CUSTOM");
  }

  function fast_rewind() {
    slideTimeWindow(-1.0);
  }

  function rewind() {
    slideTimeWindow(-0.3);
  }

  function forward() {
    slideTimeWindow(0.3);
  }

  function fast_forward() {
    slideTimeWindow(1.0);
  }

  function handleClose(e) {
    if (e.target.id === "dr_c") {
      setDateRange("CUSTOM");
    } else {
      let now = new Date();
      let newFrom = null;

      switch (e.target.id) {
        case "dr_1h":
          setDateRange("last hour");
          newFrom = sub(now, {
            hours: 1
          });
          break;

        case "dr_6h":
          setDateRange("last 6 hours");
          newFrom = sub(now, {
            hours: 6
          });
          break;

        case "dr_12h":
          setDateRange("last 12 hours");
          newFrom = sub(now, {
            hours: 12
          });
          break;

        case "dr_1d":
          setDateRange("today");
          newFrom = sub(now, {
            days: 1
          });
          break;

        case "dr_1w":
          setDateRange("last week");
          newFrom = sub(now, {
            weeks: 1
          });
          break;

        case "dr_1m":
          setDateRange("last month");
          newFrom = sub(now, {
            months: 1
          });
          break;

        case "dr_6m":
          setDateRange("last six months");
          newFrom = sub(now, {
            months: 6
          });
          setSelectedTo(now);
          break;

        case "dr_1y":
          setDateRange("last year");
          newFrom = sub(now, {
            years: 1
          });
          break;
      }

      dispatchTimes(newFrom, now);
    }

    setAnchorEl(null);
  }

  return useMemo(() => /*#__PURE__*/React.createElement("div", {
    style: {
      display: "flex",
      placeContent: "space-between"
    }
  }, /*#__PURE__*/React.createElement(Menu, {
    id: "menu_DrPicker",
    anchorEl: anchorEl,
    keepMounted: true,
    open: Boolean(anchorEl),
    onClose: handleClose
  }, /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_1h",
    onClick: handleClose
  }, "last hour"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_6h",
    onClick: handleClose
  }, "last 6 hours"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_12h",
    onClick: handleClose
  }, "last 12 hours"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_1d",
    onClick: handleClose
  }, "today"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_1w",
    onClick: handleClose
  }, "last week"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_1m",
    onClick: handleClose
  }, "last month"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_6m",
    onClick: handleClose
  }, "last 6 months"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_1y",
    onClick: handleClose
  }, "last year"), /*#__PURE__*/React.createElement(MenuItem, {
    id: "dr_c",
    onClick: handleClose
  }, "custom")), /*#__PURE__*/React.createElement(Button, {
    endIcon: /*#__PURE__*/React.createElement(FontAwesomeIcon, {
      icon: faCalendarAlt
    }),
    color: "primary",
    variant: "outlined",
    style: {
      paddingLeft: "5pt",
      marginRight: "3rem"
    },
    id: "dateRangeSelector",
    "aria-controls": "simple-menu",
    "aria-haspopup": "true",
    onClick: e => setAnchorEl(e.currentTarget)
  }, dateRange), /*#__PURE__*/React.createElement(FontAwesomeIcon, {
    onClick: fast_rewind,
    style: {
      cursor: "pointer"
    },
    size: "2x",
    color: "#728ba6",
    icon: faChevronDoubleLeft
  }), /*#__PURE__*/React.createElement(FontAwesomeIcon, {
    onClick: rewind,
    style: {
      cursor: "pointer"
    },
    size: "2x",
    color: "#728ba6",
    icon: faChevronLeft
  }), /*#__PURE__*/React.createElement(KeyboardDateTimePicker, {
    id: "daterange_from",
    value: selectedFrom,
    maxDate: selectedTo,
    format: "yyyy-MM-dd HH:mm",
    ampm: false,
    onKeyDown: handleKeyEvent,
    onChange: setSelectedFrom,
    KeyboardButtonProps: {
      size: "small"
    },
    keyboardIcon: /*#__PURE__*/React.createElement(FontAwesomeIcon, {
      color: "#728ba6",
      icon: faCalendar
    })
  }), /*#__PURE__*/React.createElement(KeyboardDateTimePicker, {
    id: "daterange_to",
    value: selectedTo,
    minDate: selectedFrom,
    format: "yyyy-MM-dd HH:mm",
    ampm: false,
    onKeyDown: handleKeyEvent,
    onChange: setSelectedTo,
    KeyboardButtonProps: {
      size: "small"
    },
    keyboardIcon: /*#__PURE__*/React.createElement(FontAwesomeIcon, {
      color: "#728ba6",
      icon: faCalendar
    })
  }), /*#__PURE__*/React.createElement(FontAwesomeIcon, {
    onClick: forward,
    style: {
      cursor: "pointer"
    },
    size: "2x",
    color: "#728ba6",
    icon: faChevronRight
  }), /*#__PURE__*/React.createElement(FontAwesomeIcon, {
    onClick: fast_forward,
    style: {
      cursor: "pointer"
    },
    size: "2x",
    color: "#728ba6",
    icon: faChevronDoubleRight
  }), /*#__PURE__*/React.createElement(FontAwesomeIcon, {
    onClick: toggle_autoupdate,
    style: {
      cursor: "pointer"
    },
    size: "2x",
    color: dateRange === "CUSTOM" ? "728ba655" : "#728ba6",
    icon: faSync,
    disabled: dateRange === "CUSTOM",
    inverse: state.plotsAutoUpdate && dateRange !== "CUSTOM"
  })), [selectedFrom, selectedTo, state.timeSelection, state.plotsAutoUpdate, anchorEl]);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2pzeC9AaWFuYWx5dGljcy9kNGQvY29tcG9uZW50cy9EYXRlUmFuZ2VQaWNrZXIuanN4Il0sIm5hbWVzIjpbIlJlYWN0IiwidXNlU3RhdGUiLCJ1c2VNZW1vIiwidXNlRWZmZWN0IiwiS2V5Ym9hcmREYXRlVGltZVBpY2tlciIsInN1YiIsInVzZVN0YXRlVmFsdWUiLCJCdXR0b24iLCJNZW51IiwiTWVudUl0ZW0iLCJUeXBvZ3JhcGh5IiwiRm9udEF3ZXNvbWVJY29uIiwiZmFDYWxlbmRhciIsImZhQ2FsZW5kYXJBbHQiLCJmYUNoZXZyb25MZWZ0IiwiZmFDaGV2cm9uUmlnaHQiLCJmYUNoZXZyb25Eb3VibGVMZWZ0IiwiZmFDaGV2cm9uRG91YmxlUmlnaHQiLCJmYVN5bmMiLCJEYXRlUmFuZ2VQaWNrZXIiLCJwcm9wcyIsInN0YXRlIiwiZGlzcGF0Y2giLCJmcm9tIiwidG8iLCJ0aW1lU2VsZWN0aW9uIiwic2VsZWN0ZWRGcm9tIiwic2V0U2VsZWN0ZWRGcm9tIiwic2VsZWN0ZWRUbyIsInNldFNlbGVjdGVkVG8iLCJhbmNob3JFbCIsInNldEFuY2hvckVsIiwiZGF0ZVJhbmdlIiwic2V0RGF0ZVJhbmdlIiwibW9kZSIsInBsb3RzQXV0b1VwZGF0ZSIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJkaXNwYXRjaFRpbWVzIiwiRGF0ZSIsImNsZWFySW50ZXJ2YWwiLCJ0b2dnbGVfYXV0b3VwZGF0ZSIsInR5cGUiLCJuZXdGcm9tIiwibmV3VG8iLCJwYXlsb2FkIiwiZGlzcGF0Y2hTZWxlY3RlZFRpbWVzIiwiaGFuZGxlS2V5RXZlbnQiLCJldmVudCIsImtleSIsInNsaWRlVGltZVdpbmRvdyIsImZhY3RvciIsImRlbHRhIiwiZ2V0VGltZSIsImZhc3RfcmV3aW5kIiwicmV3aW5kIiwiZm9yd2FyZCIsImZhc3RfZm9yd2FyZCIsImhhbmRsZUNsb3NlIiwiZSIsInRhcmdldCIsImlkIiwibm93IiwiaG91cnMiLCJkYXlzIiwid2Vla3MiLCJtb250aHMiLCJ5ZWFycyIsImRpc3BsYXkiLCJwbGFjZUNvbnRlbnQiLCJCb29sZWFuIiwicGFkZGluZ0xlZnQiLCJtYXJnaW5SaWdodCIsImN1cnJlbnRUYXJnZXQiLCJjdXJzb3IiLCJzaXplIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPQSxLQUFQLElBQWdCQyxRQUFoQixFQUEwQkMsT0FBMUIsRUFBbUNDLFNBQW5DLFFBQW9ELE9BQXBEO0FBRUEsU0FBU0Msc0JBQVQsUUFBdUMsc0JBQXZDO0FBQ0EsU0FBU0MsR0FBVCxRQUFvQixVQUFwQjtBQUNBLFNBQVNDLGFBQVQsUUFBOEIsMkNBQTlCO0FBRUEsU0FBU0MsTUFBVCxFQUFpQkMsSUFBakIsRUFBdUJDLFFBQXZCLEVBQWlDQyxVQUFqQyxRQUFtRCxtQkFBbkQ7QUFFQSxTQUFTQyxlQUFULFFBQWdDLGdDQUFoQztBQUVBLFNBQ0VDLFVBREYsRUFFRUMsYUFGRixFQUdFQyxhQUhGLEVBSUVDLGNBSkYsRUFLRUMsbUJBTEYsRUFNRUMsb0JBTkYsRUFPRUMsTUFQRixRQVFPLG1DQVJQO0FBVUEsZUFBZUMsZUFBZSxHQUFHLFVBQVVDLEtBQVYsRUFBaUI7QUFDaEQsUUFBTSxDQUFDQyxLQUFELEVBQVFDLFFBQVIsSUFBb0JoQixhQUFhLEVBQXZDO0FBQ0EsUUFBTTtBQUFFaUIsSUFBQUEsSUFBRjtBQUFRQyxJQUFBQTtBQUFSLE1BQWVILEtBQUssQ0FBQ0ksYUFBM0I7QUFFQSxRQUFNLENBQUNDLFlBQUQsRUFBZUMsZUFBZixJQUFrQzFCLFFBQVEsQ0FBQ3NCLElBQUQsQ0FBaEQ7QUFDQSxRQUFNLENBQUNLLFVBQUQsRUFBYUMsYUFBYixJQUE4QjVCLFFBQVEsQ0FBQ3VCLEVBQUQsQ0FBNUM7QUFFQSxRQUFNLENBQUNNLFFBQUQsRUFBV0MsV0FBWCxJQUEwQjlCLFFBQVEsQ0FBQyxJQUFELENBQXhDO0FBQ0EsUUFBTSxDQUFDK0IsU0FBRCxFQUFZQyxZQUFaLElBQTRCaEMsUUFBUSxDQUFDb0IsS0FBSyxDQUFDSSxhQUFOLENBQW9CUyxJQUFyQixD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QXZCO0FBQWlDLE1BQUEsSUFBSSxFQUFFL0Q7QUFBdkM7QUFUaEIsSUExRUYsZUFxRkUsb0JBQUMsZUFBRDtBQUNFLElBQUEsT0FBTyxFQUFFNEMsT0FEWDtBQUVFLElBQUEsS0FBSyxFQUFFO0FBQUVrQixNQUFBQSxNQUFNLEVBQUU7QUFBVixLQUZUO0FBR0UsSUFBQSxJQUFJLEVBQUMsSUFIUDtBQUlFLElBQUEsS0FBSyxFQUFDLFNBSlI7QUFLRSxJQUFBLElBQUksRUFBRTNEO0FBTFIsSUFyRkYsZUE0RkUsb0JBQUMsZUFBRDtBQUNFLElBQUEsT0FBTyxFQUFFMEMsWUFEWDtBQUVFLElBQUEsS0FBSyxFQUFFO0FBQUVpQixNQUFBQSxNQUFNLEVBQUU7QUFBVixLQUZUO0FBR0UsSUFBQSxJQUFJLEVBQUMsSUFIUDtBQUlFLElBQUEsS0FBSyxFQUFDLFNBSlI7QUFLRSxJQUFBLElBQUksRUFBRXpEO0FBTFIsSUE1RkYsZUFtR0Usb0JBQUMsZUFBRDtBQUNFLElBQUEsT0FBTyxFQUFFd0IsaUJBRFg7QUFFRSxJQUFBLEtBQUssRUFBRTtBQUFFaUMsTUFBQUEsTUFBTSxFQUFFO0FBQVYsS0FGVDtBQUdFLElBQUEsSUFBSSxFQUFDLElBSFA7QUFJRSxJQUFBLEtBQUssRUFBRTFDLFNBQVMsS0FBSyxRQUFkLEdBQXlCLFVBQXpCLEdBQXNDLFNBSi9DO0FBS0UsSUFBQSxJQUFJLEVBQUVkLE1BTFI7QUFNRSxJQUFBLFFBQVEsRUFBRWMsU0FBUyxLQUFLLFFBTjFCO0FBT0UsSUFBQSxPQUFPLEVBQUVYLEtBQUssQ0FBQ2MsZUFBTixJQUF5QkgsU0FBUyxLQUFLO0FBUGxELElBbkdGLENBRlUsRUFnSFosQ0FDRU4sWUFERixFQUVFRSxVQUZGLEVBR0VQLEtBQUssQ0FBQ0ksYUFIUixFQUlFSixLQUFLLENBQUNjLGVBSlIsRUFLRUwsUUFMRixDQWhIWSxDQUFkO0FBd0hELENBbFBEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VNZW1vLCB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcclxuXHJcbmltcG9ydCB7IEtleWJvYXJkRGF0ZVRpbWVQaWNrZXIgfSBmcm9tIFwiQG1hdGVyaWFsLXVpL3BpY2tlcnNcIjtcclxuaW1wb3J0IHsgc3ViIH0gZnJvbSBcImRhdGUtZm5zXCI7XHJcbmltcG9ydCB7IHVzZVN0YXRlVmFsdWUgfSBmcm9tIFwiL0BpYW5hbHl0aWNzL2Q0ZC9jb21wb25lbnRzL1N0YXRlUHJvdmlkZXJcIjtcclxuXHJcbmltcG9ydCB7IEJ1dHRvbiwgTWVudSwgTWVudUl0ZW0sIFR5cG9ncmFwaHkgfSBmcm9tIFwiQG1hdGVyaWFsLXVpL2NvcmVcIjtcclxuXHJcbmltcG9ydCB7IEZvbnRBd2Vzb21lSWNvbiB9IGZyb20gXCJAZm9ydGF3ZXNvbWUvcmVhY3QtZm9udGF3ZXNvbWVcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgZmFDYWxlbmRhcixcclxuICBmYUNhbGVuZGFyQWx0LFxyXG4gIGZhQ2hldnJvbkxlZnQsXHJcbiAgZmFDaGV2cm9uUmlnaHQsXHJcbiAgZmFDaGV2cm9uRG91YmxlTGVmdCxcclxuICBmYUNoZXZyb25Eb3VibGVSaWdodCxcclxuICBmYVN5bmMsXHJcbn0gZnJvbSBcIkBmb3J0YXdlc29tZS9mcmVlLXNvbGlkLXN2Zy1pY29uc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRGF0ZVJhbmdlUGlja2VyID0gZnVuY3Rpb24gKHByb3BzKSB7XHJcbiAgY29uc3QgW3N0YXRlLCBkaXNwYXRjaF0gPSB1c2VTdGF0ZVZhbHVlKCk7XHJcbiAgY29uc3QgeyBmcm9tLCB0byB9ID0gc3RhdGUudGltZVNlbGVjdGlvbjtcclxuXHJcbiAgY29uc3QgW3NlbGVjdGVkRnJvbSwgc2V0U2VsZWN0ZWRGcm9tXSA9IHVzZVN0YXRlKGZyb20pO1xyXG4gIGNvbnN0IFtzZWxlY3RlZFRvLCBzZXRTZWxlY3RlZFRvXSA9IHVzZVN0YXRlKHRvKTtcclxuXHJcbiAgY29uc3QgW2FuY2hvckVsLCBzZXRBbmNob3JFbF0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbZGF0ZVJhbmdlLCBzZXREYXRlUmFuZ2VdID0gdXNlU3RhdGUoc3RhdGUudGltZVNlbGVjdGlvbi5tb2RlKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChzdGF0ZS5wbG90c0F1dG9VcGRhdGUpIHtcclxuICAgICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKGRhdGVSYW5nZSAhPT0gXCJDVVNUT01cIikge1xyXG4gICAgICAgICAgZGlzcGF0Y2hUaW1lcyhmcm9tLCBuZXcgRGF0ZSgpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDUwMDApO1xyXG5cclxuICAgICAgcmV0dXJuICgpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xyXG4gICAgfVxyXG4gIH0sIFtzdGF0ZS5wbG90c0F1dG9VcGRhdGVdKTtcclxuXHJcbiAgZnVuY3Rpb24gdG9nZ2xlX2F1dG91cGRhdGUoKSB7XHJcbiAgICBkaXNwYXRjaCh7IHR5cGU6IFwiVE9HR0xFX1JFRlJFU0hcIiwgZGlzcGF0Y2g6IGRpc3BhdGNoIH0pO1xyXG4gIH1cclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIHNldFNlbGVjdGVkRnJvbShmcm9tKTtcclxuICAgIHNldFNlbGVjdGVkVG8odG8pO1xyXG4gIH0sIFtmcm9tLCB0b10pO1xyXG5cclxuICBmdW5jdGlvbiBkaXNwYXRjaFRpbWVzKG5ld0Zyb20sIG5ld1RvKSB7XHJcbiAgICBpZiAobmV3RnJvbSA8IG5ld1RvKSB7XHJcbiAgICAgIGRpc3BhdGNoKHtcclxuICAgICAgICB0eXBlOiBcIlNFTEVDVF9USU1FX1JBTkdFXCIsXHJcbiAgICAgICAgcGF5bG9hZDogeyBmcm9tOiBuZXdGcm9tLCB0bzogbmV3VG8gfSxcclxuICAgICAgICBkaXNwYXRjaDogZGlzcGF0Y2gsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZGlzcGF0Y2hTZWxlY3RlZFRpbWVzKCkge1xyXG4gICAgZGlzcGF0Y2hUaW1lcyhzZWxlY3RlZEZyb20sIHNlbGVjdGVkVG8pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGFuZGxlS2V5RXZlbnQoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICBkaXNwYXRjaFNlbGVjdGVkVGltZXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNsaWRlVGltZVdpbmRvdyhmYWN0b3IpIHtcclxuICAgIGNvbnN0IGRlbHRhID0gc2VsZWN0ZWRUbyAtIHNlbGVjdGVkRnJvbTtcclxuICAgIGRpc3BhdGNoVGltZXMoXHJcbiAgICAgIG5ldyBEYXRlKGZyb20uZ2V0VGltZSgpICsgZmFjdG9yICogZGVsdGEpLFxyXG4gICAgICBuZXcgRGF0ZSh0by5nZXRUaW1lKCkgKyBmYWN0b3IgKiBkZWx0YSlcclxuICAgICk7XHJcbiAgICBzZXREYXRlUmFuZ2UoXCJDVVNUT01cIik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBmYXN0X3Jld2luZCgpIHtcclxuICAgIHNsaWRlVGltZVdpbmRvdygtMS4wKTtcclxuICB9XHJcbiAgZnVuY3Rpb24gcmV3aW5kKCkge1xyXG4gICAgc2xpZGVUaW1lV2luZG93KC0wLjMpO1xyXG4gIH1cclxuICBmdW5jdGlvbiBmb3J3YXJkKCkge1xyXG4gICAgc2xpZGVUaW1lV2luZG93KDAuMyk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIGZhc3RfZm9yd2FyZCgpIHtcclxuICAgIHNsaWRlVGltZVdpbmRvdygxLjApO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGFuZGxlQ2xvc2UoZSkge1xyXG4gICAgaWYgKGUudGFyZ2V0LmlkID09PSBcImRyX2NcIikge1xyXG4gICAgICBzZXREYXRlUmFuZ2UoXCJDVVNUT01cIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsZXQgbm93ID0gbmV3IERhdGUoKTtcclxuICAgICAgbGV0IG5ld0Zyb20gPSBudWxsO1xyXG5cclxuICAgICAgc3dpdGNoIChlLnRhcmdldC5pZCkge1xyXG4gICAgICAgIGNhc2UgXCJkcl8xaFwiOlxyXG4gICAgICAgICAgc2V0RGF0ZVJhbmdlKFwibGFzdCBob3VyXCIpO1xyXG4gICAgICAgICAgbmV3RnJvbSA9IHN1Yihub3csIHsgaG91cnM6IDEgfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiZHJfNmhcIjpcclxuICAgICAgICAgIHNldERhdGVSYW5nZShcImxhc3QgNiBob3Vyc1wiKTtcclxuICAgICAgICAgIG5ld0Zyb20gPSBzdWIobm93LCB7IGhvdXJzOiA2IH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImRyXzEyaFwiOlxyXG4gICAgICAgICAgc2V0RGF0ZVJhbmdlKFwibGFzdCAxMiBob3Vyc1wiKTtcclxuICAgICAgICAgIG5ld0Zyb20gPSBzdWIobm93LCB7IGhvdXJzOiAxMiB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJkcl8xZFwiOlxyXG4gICAgICAgICAgc2V0RGF0ZVJhbmdlKFwidG9kYXlcIik7XHJcbiAgICAgICAgICBuZXdGcm9tID0gc3ViKG5vdywgeyBkYXlzOiAxIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImRyXzF3XCI6XHJcbiAgICAgICAgICBzZXREYXRlUmFuZ2UoXCJsYXN0IHdlZWtcIik7XHJcbiAgICAgICAgICBuZXdGcm9tID0gc3ViKG5vdywgeyB3ZWVrczogMSB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJkcl8xbVwiOlxyXG4gICAgICAgICAgc2V0RGF0ZVJhbmdlKFwibGFzdCBtb250aFwiKTtcclxuICAgICAgICAgIG5ld0Zyb20gPSBzdWIobm93LCB7IG1vbnRoczogMSB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJkcl82bVwiOlxyXG4gICAgICAgICAgc2V0RGF0ZVJhbmdlKFwibGFzdCBzaXggbW9udGhzXCIpO1xyXG4gICAgICAgICAgbmV3RnJvbSA9IHN1Yihub3csIHsgbW9udGhzOiA2IH0pO1xyXG4gICAgICAgICAgc2V0U2VsZWN0ZWRUbyhub3cpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImRyXzF5XCI6XHJcbiAgICAgICAgICBzZXREYXRlUmFuZ2UoXCJsYXN0IHllYXJcIik7XHJcbiAgICAgICAgICBuZXdGcm9tID0gc3ViKG5vdywgeyB5ZWFyczogMSB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBkaXNwYXRjaFRpbWVzKG5ld0Zyb20sIG5vdyk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0QW5jaG9yRWwobnVsbCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdXNlTWVtbyhcclxuICAgICgpID0+IChcclxuICAgICAgPGRpdiBzdHlsZT17eyBkaXNwbGF5OiBcImZsZXhcIiwgcGxhY2VDb250ZW50OiBcInNwYWNlLWJldHdlZW5cIiB9fT5cclxuICAgICAgICA8TWVudVxyXG4gICAgICAgICAgaWQ9XCJtZW51X0RyUGlja2VyXCJcclxuICAgICAgICAgIGFuY2hvckVsPXthbmNob3JFbH1cclxuICAgICAgICAgIGtlZXBNb3VudGVkXHJcbiAgICAgICAgICBvcGVuPXtCb29sZWFuKGFuY2hvckVsKX1cclxuICAgICAgICAgIG9uQ2xvc2U9e2hhbmRsZUNsb3NlfVxyXG4gICAgICAgID5cclxuICAgICAgICAgIDxNZW51SXRlbSBpZD1cImRyXzFoXCIgb25DbGljaz17aGFuZGxlQ2xvc2V9PlxyXG4gICAgICAgICAgICBsYXN0IGhvdXJcclxuICAgICAgICAgIDwvTWVudUl0ZW0+XHJcbiAgICAgICAgICA8TWVudUl0ZW0gaWQ9XCJkcl82aFwiIG9uQ2xpY2s9e2hhbmRsZUNsb3NlfT5cclxuICAgICAgICAgICAgbGFzdCA2IGhvdXJzXHJcbiAgICAgICAgICA8L01lbnVJdGVtPlxyXG4gICAgICAgICAgPE1lbnVJdGVtIGlkPVwiZHJfMTJoXCIgb25DbGljaz17aGFuZGxlQ2xvc2V9PlxyXG4gICAgICAgICAgICBsYXN0IDEyIGhvdXJzXHJcbiAgICAgICAgICA8L01lbnVJdGVtPlxyXG5cclxuICAgICAgICAgIDxNZW51SXRlbSBpZD1cImRyXzFkXCIgb25DbGljaz17aGFuZGxlQ2xvc2V9PlxyXG4gICAgICAgICAgICB0b2RheVxyXG4gICAgICAgICAgPC9NZW51SXRlbT5cclxuICAgICAgICAgIDxNZW51SXRlbSBpZD1cImRyXzF3XCIgb25DbGljaz17aGFuZGxlQ2xvc2V9PlxyXG4gICAgICAgICAgICBsYXN0IHdlZWtcclxuICAgICAgICAgIDwvTWVudUl0ZW0+XHJcbiAgICAgICAgICA8TWVudUl0ZW0gaWQ9XCJkcl8xbVwiIG9uQ2xpY2s9e2hhbmRsZUNsb3NlfT5cclxuICAgICAgICAgICAgbGFzdCBtb250aFxyXG4gICAgICAgICAgPC9NZW51SXRlbT5cclxuICAgICAgICAgIDxNZW51SXRlbSBpZD1cImRyXzZtXCIgb25DbGljaz17aGFuZGxlQ2xvc2V9PlxyXG4gICAgICAgICAgICBsYXN0IDYgbW9udGhzXHJcbiAgICAgICAgICA8L01lbnVJdGVtPlxyXG4gICAgICAgICAgPE1lbnVJdGVtIGlkPVwiZHJfMXlcIiBvbkNsaWNrPXtoYW5kbGVDbG9zZX0+XHJcbiAgICAgICAgICAgIGxhc3QgeWVhclxyXG4gICAgICAgICAgPC9NZW51SXRlbT5cclxuICAgICAgICAgIDxNZW51SXRlbSBpZD1cImRyX2NcIiBvbkNsaWNrPXtoYW5kbGVDbG9zZX0+XHJcbiAgICAgICAgICAgIGN1c3RvbVxyXG4gICAgICAgICAgPC9NZW51SXRlbT5cclxuICAgICAgICA8L01lbnU+XHJcbiAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgZW5kSWNvbj17PEZvbnRBd2Vzb21lSWNvbiBpY29uPXtmYUNhbGVuZGFyQWx0fSAvPn1cclxuICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXHJcbiAgICAgICAgICB2YXJpYW50PVwib3V0bGluZWRcIlxyXG4gICAgICAgICAgc3R5bGU9e3sgcGFkZGluZ0xlZnQ6IFwiNXB0XCIsIG1hcmdpblJpZ2h0OiBcIjNyZW1cIiB9fVxyXG4gICAgICAgICAgaWQ9XCJkYXRlUmFuZ2VTZWxlY3RvclwiXHJcbiAgICAgICAgICBhcmlhLWNvbnRyb2xzPVwic2ltcGxlLW1lbnVcIlxyXG4gICAgICAgICAgYXJpYS1oYXNwb3B1cD1cInRydWVcIlxyXG4gICAgICAgICAgb25DbGljaz17KGUpID0+IHNldEFuY2hvckVsKGUuY3VycmVudFRhcmdldCl9XHJcbiAgICAgICAgPlxyXG4gICAgICAgICAge2RhdGVSYW5nZX1cclxuICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICA8Rm9udEF3ZXNvbWVJY29uXHJcbiAgICAgICAgICBvbkNsaWNrPXtmYXN0X3Jld2luZH1cclxuICAgICAgICAgIHN0eWxlPXt7IGN1cnNvcjogXCJwb2ludGVyXCIgfX1cclxuICAgICAgICAgIHNpemU9XCIyeFwiXHJcbiAgICAgICAgICBjb2xvcj1cIiM3MjhiYTZcIlxyXG4gICAgICAgICAgaWNvbj17ZmFDaGV2cm9uRG91YmxlTGVmdH1cclxuICAgICAgICAvPlxyXG4gICAgICAgIDxGb250QXdlc29tZUljb25cclxuICAgICAgICAgIG9uQ2xpY2s9e3Jld2luZH1cclxuICAgICAgICAgIHN0eWxlPXt7IGN1cnNvcjogXCJwb2ludGVyXCIgfX1cclxuICAgICAgICAgIHNpemU9XCIyeFwiXHJcbiAgICAgICAgICBjb2xvcj1cIiM3MjhiYTZcIlxyXG4gICAgICAgICAgaWNvbj17ZmFDaGV2cm9uTGVmdH1cclxuICAgICAgICAvPlxyXG4gICAgICAgIDxLZXlib2FyZERhdGVUaW1lUGlja2VyXHJcbiAgICAgICAgICBpZD1cImRhdGVyYW5nZV9mcm9tXCJcclxuICAgICAgICAgIHZhbHVlPXtzZWxlY3RlZEZyb219XHJcbiAgICAgICAgICBtYXhEYXRlPXtzZWxlY3RlZFRvfVxyXG4gICAgICAgICAgZm9ybWF0PVwieXl5eS1NTS1kZCBISDptbVwiXHJcbiAgICAgICAgICBhbXBtPXtmYWxzZX1cclxuICAgICAgICAgIG9uS2V5RG93bj17aGFuZGxlS2V5RXZlbnR9XHJcbiAgICAgICAgICBvbkNoYW5nZT17c2V0U2VsZWN0ZWRGcm9tfVxyXG4gICAgICAgICAgS2V5Ym9hcmRCdXR0b25Qcm9wcz17eyBzaXplOiBcInNtYWxsXCIgfX1cclxuICAgICAgICAgIGtleWJvYXJkSWNvbj17PEZvbnRBd2Vzb21lSWNvbiBjb2xvcj1cIiM3MjhiYTZcIiBpY29uPXtmYUNhbGVuZGFyfSAvPn1cclxuICAgICAgICAvPlxyXG4gICAgICAgIDxLZXlib2FyZERhdGVUaW1lUGlja2VyXHJcbiAgICAgICAgICBpZD1cImRhdGVyYW5nZV90b1wiXHJcbiAgICAgICAgICB2YWx1ZT17c2VsZWN0ZWRUb31cclxuICAgICAgICAgIG1pbkRhdGU9e3NlbGVjdGVkRnJvbX1cclxuICAgICAgICAgIGZvcm1hdD1cInl5eXktTU0tZGQgSEg6bW1cIlxyXG4gICAgICAgICAgYW1wbT17ZmFsc2V9XHJcbiAgICAgICAgICBvbktleURvd249e2hhbmRsZUtleUV2ZW50fVxyXG4gICAgICAgICAgb25DaGFuZ2U9e3NldFNlbGVjdGVkVG99XHJcbiAgICAgICAgICBLZXlib2FyZEJ1dHRvblByb3BzPXt7IHNpemU6IFwic21hbGxcIiB9fVxyXG4gICAgICAgICAga2V5Ym9hcmRJY29uPXs8Rm9udEF3ZXNvbWVJY29uIGNvbG9yPVwiIzcyOGJhNlwiIGljb249e2ZhQ2FsZW5kYXJ9IC8+fVxyXG4gICAgICAgIC8+XHJcbiAgICAgICAgPEZvbnRBd2Vzb21lSWNvblxyXG4gICAgICAgICAgb25DbGljaz17Zm9yd2FyZH1cclxuICAgICAgICAgIHN0eWxlPXt7IGN1cnNvcjogXCJwb2ludGVyXCIgfX1cclxuICAgICAgICAgIHNpemU9XCIyeFwiXHJcbiAgICAgICAgICBjb2xvcj1cIiM3MjhiYTZcIlxyXG4gICAgICAgICAgaWNvbj17ZmFDaGV2cm9uUmlnaHR9XHJcbiAgICAgICAgLz5cclxuICAgICAgICA8Rm9udEF3ZXNvbWVJY29uXHJcbiAgICAgICAgICBvbkNsaWNrPXtmYXN0X2ZvcndhcmR9XHJcbiAgICAgICAgICBzdHlsZT17eyBjdXJzb3I6IFwicG9pbnRlclwiIH19XHJcbiAgICAgICAgICBzaXplPVwiMnhcIlxyXG4gICAgICAgICAgY29sb3I9XCIjNzI4YmE2XCJcclxuICAgICAgICAgIGljb249e2ZhQ2hldnJvbkRvdWJsZVJpZ2h0fVxyXG4gICAgICAgIC8+XHJcbiAgICAgICAgPEZvbnRBd2Vzb21lSWNvblxyXG4gICAgICAgICAgb25DbGljaz17dG9nZ2xlX2F1dG91cGRhdGV9XHJcbiAgICAgICAgICBzdHlsZT17eyBjdXJzb3I6IFwicG9pbnRlclwiIH19XHJcbiAgICAgICAgICBzaXplPVwiMnhcIlxyXG4gICAgICAgICAgY29sb3I9e2RhdGVSYW5nZSA9PT0gXCJDVVNUT01cIiA/IFwiNzI4YmE2NTVcIiA6IFwiIzcyOGJhNlwifVxyXG4gICAgICAgICAgaWNvbj17ZmFTeW5jfVxyXG4gICAgICAgICAgZGlzYWJsZWQ9e2RhdGVSYW5nZSA9PT0gXCJDVVNUT01cIn1cclxuICAgICAgICAgIGludmVyc2U9e3N0YXRlLnBsb3RzQXV0b1VwZGF0ZSAmJiBkYXRlUmFuZ2UgIT09IFwiQ1VTVE9NXCJ9XHJcbiAgICAgICAgLz5cclxuICAgICAgPC9kaXY+XHJcbiAgICApLFxyXG4gICAgW1xyXG4gICAgICBzZWxlY3RlZEZyb20sXHJcbiAgICAgIHNlbGVjdGVkVG8sXHJcbiAgICAgIHN0YXRlLnRpbWVTZWxlY3Rpb24sXHJcbiAgICAgIHN0YXRlLnBsb3RzQXV0b1VwZGF0ZSxcclxuICAgICAgYW5jaG9yRWwsXHJcbiAgICBdXHJcbiAgKTtcclxufTtcclxuIl19